<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="proj.spring.mes.dao.mapper.P0401_StockMapperDAO">
	<!-- SQL문 작성 영역 -->
	
	<!-- 전체 조회 : 여기는 ㅇㅋ -->
	<select id = "selectStock" resultType = "P0401_StockDTO">
		select
			s.stock_id, s.stock_amount, s.stock_wrap, s.item_id,
			i.item_div, i.item_name
		from v3_stock s left outer join v3_item i
		on s.item_id = i.item_id
		order by s.stock_id	
	</select>

	
	<!-- 단일 조회 : 아마 ㅇㅋ -->
	<select id = "selectOneStock" resultType = "P0401_StockDTO">
		select
			s.stock_id, s.stock_amount, s.stock_wrap, s.item_id,
			i.item_div, i.item_name
		from v3_stock s left outer join v3_item i
		on s.item_id = i.item_id
		where s.stock_id = #{stock_id}
		order by s.stock_id	
	</select>
	
	<!-- 수정 : 아마 ㅇㅋ-->
	<update id = "updateStock" parameterType = "P0401_StockDTO">
		update v3_stock
		set stock_amount = #{stock_amount},
			stock_wrap = #{stock_wrap},
			item_id = #{item_id}
		where stock_id = #{stock_id}
	</update>
	
	<!-- 삭제 : 아마 ㅇㅋ-->
	<delete id = "deleteStock" parameterType = "P0401_StockDTO">
		delete from v3_stock
		where stock_id = #{stock_id}
	</delete>
	
	<!-- 삽입 : 아마 ㅇㅋ -->
	<insert id = "insertStock" parameterType = "P0401_StockDTO">
		<selectKey keyProperty="stock_id" resultType="string" order="BEFORE">
		  select 'C' || TO_CHAR(SYSDATE, 'YYMMDD') || LPAD(stock_id_seq.NEXTVAL, 4, '0')
		  from dual
		</selectKey>
		
		insert into v3_stock (
			stock_id, stock_amount, stock_wrap, item_id
		)
		values (
			#{stock_id}, #{stock_amount}, #{stock_wrap}, #{item_id}
		)
	</insert>
</mapper>